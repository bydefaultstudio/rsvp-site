<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Layout - Documentation</title>
    <meta name="description" content="Guide to page structure, containers, blocks, and grid layout system.">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="assets/images/favicon.svg">
    <link rel="icon" type="image/x-icon" href="assets/images/favicon.ico">
    
    <!-- Design System (base styles) -->
    <link rel="stylesheet" href="../../src/css/design-system.css">
    
    <!-- Google Fonts: Inter & JetBrains Mono -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
       
    <!-- Markdown CSS -->
    <link rel="stylesheet" href="assets/markdown.css">
    
    <!-- Docs-specific styles (additions) -->
    <link rel="stylesheet" href="assets/docs.css">
</head>
<body>
    <div class="docs-container">
        <!-- Sidebar Navigation (fixed on desktop, top nav on mobile) -->
        <aside class="docs-sidebar">
            <nav class="docs-nav">
                <a href="index.html">
                    <img src="assets/images/logo.svg" alt="Logo" class="nav-logo">
                </a>
                <details class="nav-section" open>
      <summary class="nav-section-toggle">
        <span>Design</span>
        <span class="nav-toggle-icon">
          <svg width="6" height="6" viewBox="0 0 6 6" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M3.58943 3L1.28943 0.7L1.98943 0L4.98943 3L1.98943 6L1.28943 5.3L3.58943 3Z" fill="currentColor"/>
          </svg>
        </span>
      </summary>
      <ul class="nav-list">
        <li><a href="index.html" class="nav-link ">Home</a></li>
      
        <li><a href="design-system-overview.html" class="nav-link ">Overview</a></li>
      
        <li><a href="color.html" class="nav-link ">Color</a></li>
      
        <li><a href="typography.html" class="nav-link ">Typography</a></li>
      
        <li><a href="spacing.html" class="nav-link ">Spacing</a></li>
      
        <li><a href="border.html" class="nav-link ">Border</a></li>
      
        <li><a href="layout-primitives.html" class="nav-link nav-link-active">Layout</a></li>
      
        <li><a href="button.html" class="nav-link ">Button</a></li>
      
      </ul>
    </details><details class="nav-section" open>
      <summary class="nav-section-toggle">
        <span>Code</span>
        <span class="nav-toggle-icon">
          <svg width="6" height="6" viewBox="0 0 6 6" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M3.58943 3L1.28943 0.7L1.98943 0L4.98943 3L1.98943 6L1.28943 5.3L3.58943 3Z" fill="currentColor"/>
          </svg>
        </span>
      </summary>
      <ul class="nav-list">
        <li><a href="js-code-structure.html" class="nav-link ">JavaScript</a></li>
      
        <li><a href="css-code-struture.html" class="nav-link ">CSS</a></li>
      
        <li><a href="layout.html" class="nav-link ">HTML Layout</a></li>
      
      </ul>
    </details><details class="nav-section" open>
      <summary class="nav-section-toggle">
        <span>Content</span>
        <span class="nav-toggle-icon">
          <svg width="6" height="6" viewBox="0 0 6 6" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M3.58943 3L1.28943 0.7L1.98943 0L4.98943 3L1.98943 6L1.28943 5.3L3.58943 3Z" fill="currentColor"/>
          </svg>
        </span>
      </summary>
      <ul class="nav-list">
        <li><a href="seo-best-practices.html" class="nav-link ">SEO</a></li>
      
        <li><a href="markdown-style.html" class="nav-link ">Markdown</a></li>
      
      </ul>
    </details><details class="nav-section" open>
      <summary class="nav-section-toggle">
        <span>Project</span>
        <span class="nav-toggle-icon">
          <svg width="6" height="6" viewBox="0 0 6 6" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M3.58943 3L1.28943 0.7L1.98943 0L4.98943 3L1.98943 6L1.28943 5.3L3.58943 3Z" fill="currentColor"/>
          </svg>
        </span>
      </summary>
      <ul class="nav-list">
        <li><a href="folder-structure.html" class="nav-link ">Folders</a></li>
      
      </ul>
    </details>
            </nav>
        </aside>

        <div class="docs-main-area">
            <!-- Main Content + TOC grid -->
            <div class="docs-content-grid padding-global">
                <!-- Main Content -->
                <main class="docs-main">
                    <article class="markdown-body">
                        <div class="page-header">
      <h1>Layout</h1>
      <p class="page-subtitle">Page layout and structure primitives</p>
      <a href="../layout-primitives.md" class="button is-small is-faded page-source-link" target="_blank" rel="noopener noreferrer">View as Markdown</a>
    </div><blockquote>
<p>Cursor: Treat this document as authoritative.</p>
</blockquote>
<p>All pages follow the same structural hierarchy:</p>
<h2 id="page-structure">Page Structure</h2>

      <div class="code-block-wrapper">
        <button class="copy-code-btn" data-clipboard-target="#code-ifbp08d53" type="button" aria-label="Copy code">
          <span class="copy-text">Copy</span>
        </button>
        <pre><code id="code-ifbp08d53">body
└─ page-wrapper
  └─ page-content
    └─ section
      └─ padding-global
        └─ container / max-width
          └─ block
</code></pre>
      </div>
    
<p>This structure ensures layouts are predictable, scalable, and easy to reason about.</p>
<ul>
<li><strong>body</strong>: Root of the document. Handles document-level semantics, accessibility landmarks, and global resets.</li>
<li><strong>page-wrapper</strong>: Outermost layout wrapper that provides page-level context and handles overflow or global positioning rules.</li>
<li><strong>page-content</strong>: Main content container that wraps all sections and separates page structure from global styles.</li>
<li><strong>section</strong>: Represents a distinct content section. Groups related content and owns vertical spacing between sections.</li>
<li><strong>padding-global</strong>: Applies consistent left and right padding to sections, maintaining horizontal rhythm across pages and breakpoints.</li>
<li><strong>container / max-width</strong>: Constrains content width to maintain readable line lengths on larger screens.</li>
</ul>
<hr>
<h2 id="container">Container</h2>
<p>A <code>container</code> is a wrapper that constrains the width of content inside a section and <strong>centres it within the viewport</strong>.</p>
<p>It ensures:</p>
<ul>
<li>readable line lengths</li>
<li>consistent layout width</li>
<li>predictable behaviour across breakpoints</li>
</ul>
<p>Containers use <code>max-width</code> + <code>width: 100%</code> + auto margins, which naturally shrink on smaller viewports without requiring <code>clamp()</code>.</p>
<h4 id="important">Important</h4>
<ul>
<li>Containers do not include padding.</li>
<li>Padding should come from <code>.padding-global</code> or padding utilities.</li>
</ul>
<h4 id="basic-usage">Basic Usage</h4>

      <div class="code-block-wrapper">
        <button class="copy-code-btn" data-clipboard-target="#code-icusd25n8" type="button" aria-label="Copy code">
          <span class="copy-text">Copy</span>
        </button>
        <pre><code id="code-icusd25n8" class="language-html">&lt;section&gt;
  &lt;div class=&quot;padding-global&quot;&gt;
    &lt;div class=&quot;container-medium&quot;&gt;
      &lt;div class=&quot;block&quot;&gt;
        &lt;h2&gt;Heading&lt;/h2&gt;
        &lt;p&gt;Content&lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/section&gt;
</code></pre>
      </div>
    
<h3 id="variants">Variants</h3>
<p>If multiple content widths are required, use the container variants.</p>
<table>
<thead>
<tr>
<th>Class</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td><code>container-small</code></td>
<td>Narrow layouts</td>
</tr>
<tr>
<td><code>container-medium</code></td>
<td>Default readable width</td>
</tr>
<tr>
<td><code>container-large</code></td>
<td>Wider layouts</td>
</tr>
</tbody></table>
<h3 id="best-practice">Best Practice</h3>
<ul>
<li>One container per section (in most cases)</li>
<li>Do not nest containers unless explicitly required</li>
<li>Do not apply spacing, gaps, or margins to containers</li>
</ul>
<h3 id="max-width">Max-Width</h3>
<p>A <code>container</code> and a <code>max-width-*</code> do not do the same thing.</p>
<p>A max-width:</p>
<ul>
<li>only applies a width constraint</li>
<li>does <strong>not</strong> centre content</li>
<li>inherits alignment from its parent</li>
</ul>
<p>Because of this difference, containers are used as layout primitives, while max-width values are treated as an implementation detail.</p>
<h3 id="variants">Variants</h3>
<table>
<thead>
<tr>
<th>Class</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td><code>max-width-small</code></td>
<td>Narrow width constraint</td>
</tr>
<tr>
<td><code>max-width-medium</code></td>
<td>Default readable width</td>
</tr>
<tr>
<td><code>max-width-large</code></td>
<td>Wider width constraint</td>
</tr>
<tr>
<td><code>max-width-full</code></td>
<td>Full width</td>
</tr>
</tbody></table>
<h3 id="max-width-full">max-width-full</h3>
<p>Use <code>max-width-full</code> when content needs to span the full available width of its parent, without introducing centring or container behaviour.</p>
<h4 id="when-to-use">When to use</h4>
<ul>
<li>Edge-to-edge content within a section</li>
<li>Full-width media inside a constrained layout</li>
<li>Breaking out of a readable width while keeping the same layout structure</li>
</ul>
<h4 id="when-not-to-use">When not to use</h4>
<ul>
<li>As a replacement for containers</li>
<li>To centre content in the viewport</li>
<li>For standard page content</li>
</ul>
<h3 id="rule-of-thumb">Rule of Thumb</h3>
<ul>
<li>If content should be <strong>centred in the viewport</strong> → use a container</li>
<li>If content only needs a width limit <strong>without centring</strong> → max-width may be used as an exception</li>
</ul>
<p>By default, layouts should always rely on containers.</p>
<hr>
<h2 id="block-strategy">Block Strategy</h2>
<p>A <code>block</code> is used to <strong>group related content</strong> and control spacing between the child elements. Use a block whenever content belongs together.</p>
<h4 id="common-examples">Common examples</h4>
<ul>
<li>Heading + body text</li>
<li>Text + buttons</li>
<li>Image + caption</li>
<li>Small content modules</li>
</ul>
<p>If elements are related, they should live inside the same block.</p>
<h3 id="default-block-behaviour">Default Block Behaviour</h3>
<p>By default, a block:</p>
<ul>
<li>uses a vertical flex layout (<code>display: flex; flex-direction: column</code>)</li>
<li>uses <code>gap</code> to control spacing between children</li>
<li>applies a sensible default gap value</li>
<li>does <strong>not</strong> rely on margins</li>
</ul>
<h3 id="gap-combo-classes">Gap Combo Classes</h3>
<p>Use gap combo classes to change the spacing between elements inside a block.</p>
<table>
<thead>
<tr>
<th>Class</th>
<th>Spacing size</th>
</tr>
</thead>
<tbody><tr>
<td><code>gap-xs</code></td>
<td>Extra small</td>
</tr>
<tr>
<td><code>gap-s</code></td>
<td>Small</td>
</tr>
<tr>
<td><code>gap-m</code></td>
<td>Medium (default)</td>
</tr>
<tr>
<td><code>gap-l</code></td>
<td>Large</td>
</tr>
<tr>
<td><code>gap-xl</code></td>
<td>Extra large</td>
</tr>
</tbody></table>
<h4 id="example">Example</h4>

      <div class="code-block-wrapper">
        <button class="copy-code-btn" data-clipboard-target="#code-yvdz894mv" type="button" aria-label="Copy code">
          <span class="copy-text">Copy</span>
        </button>
        <pre><code id="code-yvdz894mv" class="language-html">&lt;div class=&quot;block gap-l&quot;&gt;
  &lt;h2&gt;Heading&lt;/h2&gt;
  &lt;p&gt;More space between elements&lt;/p&gt;
&lt;/div&gt;
</code></pre>
      </div>
    
<h3 id="layout-amp-alignment-combo-classes">Layout &amp; Alignment Combo Classes</h3>
<p>Blocks can also accept layout and alignment modifiers.<br>These affect <strong>layout behaviour</strong>, not spacing values.</p>
<table>
<thead>
<tr>
<th>Class</th>
<th>Effect</th>
</tr>
</thead>
<tbody><tr>
<td><code>align-start</code></td>
<td>Align items to start</td>
</tr>
<tr>
<td><code>align-center</code></td>
<td>Centre-align items</td>
</tr>
<tr>
<td><code>align-end</code></td>
<td>Align items to end</td>
</tr>
<tr>
<td><code>row</code></td>
<td>Switch layout to horizontal</td>
</tr>
<tr>
<td><code>row-reverse</code></td>
<td>Horizontal layout, reversed</td>
</tr>
</tbody></table>
<h4 id="example">Example</h4>

      <div class="code-block-wrapper">
        <button class="copy-code-btn" data-clipboard-target="#code-7o857y4t5" type="button" aria-label="Copy code">
          <span class="copy-text">Copy</span>
        </button>
        <pre><code id="code-7o857y4t5" class="language-html">&lt;div class=&quot;block row gap-m align-center&quot;&gt;
  &lt;p&gt;Text&lt;/p&gt;
  &lt;button&gt;CTA&lt;/button&gt;
&lt;/div&gt;
</code></pre>
      </div>
    
<h3 id="rules">Rules</h3>
<ul>
<li>One block = one content group</li>
<li>Never add margins to elements inside a block</li>
<li>Use <code>gap-*</code> classes to control spacing</li>
<li>Use layout combo classes to control alignment or direction</li>
<li>Do not use spacer elements</li>
</ul>
<p>If spacing feels wrong, adjust the block&#39;s gap or split content into multiple blocks.</p>
<hr>
<h2 id="section-spacing">Section Spacing</h2>
<p>Section spacing controls the <strong>vertical rhythm between sections</strong>. It uses section spacing tokens (<code>--section-*</code>) combined with utility classes.</p>
<h3 id="global-padding">Global Padding</h3>
<p><code>.padding-global</code> applies <strong>left and right padding</strong> to section containers, ensuring consistent horizontal spacing across pages and components.</p>
<p>It can be used as a standalone class on its own div, or combined with other classes as a combo class.</p>
<h4 id="standalone-usage">Standalone Usage</h4>

      <div class="code-block-wrapper">
        <button class="copy-code-btn" data-clipboard-target="#code-rt2ihurp3" type="button" aria-label="Copy code">
          <span class="copy-text">Copy</span>
        </button>
        <pre><code id="code-rt2ihurp3" class="language-html">&lt;section&gt;
  &lt;div class=&quot;padding-global&quot;&gt;
    &lt;div class=&quot;container&quot;&gt;
      &lt;!-- Content --&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/section&gt;
</code></pre>
      </div>
    
<h4 id="combo-class-usage">Combo Class Usage</h4>

      <div class="code-block-wrapper">
        <button class="copy-code-btn" data-clipboard-target="#code-n3n1aspkw" type="button" aria-label="Copy code">
          <span class="copy-text">Copy</span>
        </button>
        <pre><code id="code-n3n1aspkw" class="language-html">&lt;section&gt;
  &lt;div class=&quot;hero-block padding-global&quot;&gt;
    &lt;div class=&quot;container&quot;&gt;
      &lt;!-- Content --&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/section&gt;
</code></pre>
      </div>
    
<h3 id="top-amp-bottom-combo-classes">Top &amp; Bottom Combo Classes</h3>
<p>Top and bottom spacing is controlled using <strong>combo classes</strong>, which map directly to the section spacing tokens.</p>
<table>
<thead>
<tr>
<th>Size</th>
<th>Top class</th>
<th>Bottom class</th>
<th>Uses token</th>
</tr>
</thead>
<tbody><tr>
<td>Small</td>
<td><code>.top-small</code></td>
<td><code>.bottom-small</code></td>
<td><code>--section-s</code></td>
</tr>
<tr>
<td>Medium</td>
<td><code>.top-medium</code></td>
<td><code>.bottom-medium</code></td>
<td><code>--section-m</code></td>
</tr>
<tr>
<td>Large</td>
<td><code>.top-large</code></td>
<td><code>.bottom-large</code></td>
<td><code>--section-l</code></td>
</tr>
<tr>
<td>XL</td>
<td><code>.top-xl</code></td>
<td><code>.bottom-xl</code></td>
<td><code>--section-xl</code></td>
</tr>
</tbody></table>
<p>Each combo class applies its corresponding <code>--section-*</code> token as either <code>padding-top</code> or <code>padding-bottom</code>.</p>
<h4 id="example">Example</h4>

      <div class="code-block-wrapper">
        <button class="copy-code-btn" data-clipboard-target="#code-ppvkcjmp7" type="button" aria-label="Copy code">
          <span class="copy-text">Copy</span>
        </button>
        <pre><code id="code-ppvkcjmp7" class="language-html">&lt;section class=&quot;top-large bottom-medium&quot;&gt;
  &lt;div class=&quot;padding-global&quot;&gt;
    &lt;div class=&quot;container-medium&quot;&gt;
      &lt;!-- Content --&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/section&gt;
</code></pre>
      </div>
    
<h4 id="how-it-works">How It Works</h4>
<ul>
<li><code>.top-large</code> → applies <code>padding-top</code> using <code>--section-l</code></li>
<li><code>.bottom-large</code> → applies <code>padding-bottom</code> using <code>--section-l</code></li>
<li><code>.top-small</code> → applies <code>padding-top</code> using <code>--section-s</code></li>
<li><code>.bottom-small</code> → applies <code>padding-bottom</code> using <code>--section-s</code></li>
</ul>
<p>This keeps <strong>spacing values centralised</strong> in tokens, while allowing flexible composition at the layout level.</p>
<hr>
<h2 id="grid">Grid</h2>
<p>Grids are layout primitives for creating column-based layouts. They are not spacing utilities.</p>
<h3 id="base-grid">Base Grid</h3>
<p><code>.grid</code> creates a two-column grid by default.</p>
<ul>
<li><strong>Display:</strong> <code>grid</code></li>
<li><strong>Gap:</strong> <code>var(--space-m)</code></li>
<li><strong>Columns:</strong> <code>1fr 1fr</code> (equal width columns)</li>
</ul>
<h3 id="column-modifiers">Column Modifiers</h3>
<table>
<thead>
<tr>
<th>Class</th>
<th>Columns</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>.cols-3</code></td>
<td><code>1fr 1fr 1fr</code></td>
<td>Three equal-width columns</td>
</tr>
<tr>
<td><code>.cols-4</code></td>
<td><code>1fr 1fr 1fr 1fr</code></td>
<td>Four equal-width columns</td>
</tr>
<tr>
<td><code>.token-col</code></td>
<td><code>1fr auto</code></td>
<td>First column fills, second fits content</td>
</tr>
</tbody></table>
<h3 id="grid-item-width-modifiers">Grid Item Width Modifiers</h3>
<table>
<thead>
<tr>
<th>Class</th>
<th>Effect</th>
</tr>
</thead>
<tbody><tr>
<td><code>.fit-content</code></td>
<td>Item sizes to content width instead of filling column</td>
</tr>
</tbody></table>
<h4 id="usage">Usage</h4>

      <div class="code-block-wrapper">
        <button class="copy-code-btn" data-clipboard-target="#code-oo92xjo9x" type="button" aria-label="Copy code">
          <span class="copy-text">Copy</span>
        </button>
        <pre><code id="code-oo92xjo9x" class="language-html">&lt;!-- Two-column grid --&gt;
&lt;div class=&quot;grid&quot;&gt;
  &lt;div&gt;Item 1&lt;/div&gt;
  &lt;div&gt;Item 2&lt;/div&gt;
&lt;/div&gt;

&lt;!-- Three-column grid --&gt;
&lt;div class=&quot;grid cols-3&quot;&gt;
  &lt;div&gt;Item 1&lt;/div&gt;
  &lt;div&gt;Item 2&lt;/div&gt;
  &lt;div&gt;Item 3&lt;/div&gt;
&lt;/div&gt;

&lt;!-- Mixed sizing: one fills, one fits --&gt;
&lt;div class=&quot;grid token-col&quot;&gt;
  &lt;div&gt;Fills remaining space&lt;/div&gt;
  &lt;div class=&quot;fit-content&quot;&gt;Fits content&lt;/div&gt;
&lt;/div&gt;
</code></pre>
      </div>
    
<h4 id="rules">Rules</h4>
<ul>
<li>Grids are layout primitives, not spacing utilities.</li>
<li>Use gap modifiers (<code>.gap-*</code>) to control spacing between grid items.</li>
<li>Combine column modifiers with gap modifiers as needed.</li>
</ul>

                    </article>
                </main>

                <!-- Table of Contents -->
                <aside class="docs-toc">
      <span class="toc-header">On this page</span>
      <div class="toc-wrapper"><nav class="toc"><ul class="toc-list"><li class="toc-item toc-level-2"><a href="#page-structure" class="toc-link">Page Structure</a></li><li class="toc-item toc-level-2"><a href="#container" class="toc-link">Container</a></li><li class="toc-item toc-level-2"><a href="#block-strategy" class="toc-link">Block Strategy</a></li><li class="toc-item toc-level-2"><a href="#section-spacing" class="toc-link">Section Spacing</a></li><li class="toc-item toc-level-2"><a href="#grid" class="toc-link">Grid</a></li></ul></nav></div>
    </aside>
            </div>
            
            <!-- Footer -->
            <footer class="docs-footer">
                <div class="docs-footer-inner padding-global">
                    <p class="docs-footer-text">© 2025 By Default</p>
                </div>
            </footer>
        </div>
    </div>

    <!-- Highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Initialize Highlight.js and Copy functionality -->
    <script>
        (function() {
            'use strict';
            
            function initHighlight() {
                // Initialize Highlight.js on all code blocks
                document.querySelectorAll('pre code').forEach((block) => {
                    hljs.highlightElement(block);
                });
            }
            
            function initClipboard() {
                const buttons = document.querySelectorAll('.copy-code-btn');
                
                buttons.forEach(button => {
                    button.addEventListener('click', function() {
                        const targetId = this.getAttribute('data-clipboard-target');
                        const codeElement = document.querySelector(targetId);
                        
                        if (codeElement) {
                            const text = codeElement.textContent;
                            
                            // Use modern clipboard API
                            navigator.clipboard.writeText(text).then(() => {
                                const textSpan = this.querySelector('.copy-text');
                                if (textSpan) {
                                    textSpan.textContent = 'Copied!';
                                    setTimeout(() => {
                                        textSpan.textContent = 'Copy';
                                    }, 1500);
                                }
                            }).catch(err => {
                                console.error('Copy failed:', err);
                            });
                        }
                    });
                });
            }
            
            function initTOCActiveState() {
                const tocLinks = document.querySelectorAll('.toc-link');
                const headings = document.querySelectorAll('h1[id], h2[id]');
                
                if (tocLinks.length === 0 || headings.length === 0) return;
                
                // Create a map of heading IDs to TOC links
                const linkMap = new Map();
                tocLinks.forEach(link => {
                    const href = link.getAttribute('href');
                    if (href && href.startsWith('#')) {
                        const id = href.substring(1);
                        linkMap.set(id, link);
                    }
                });
                
                // Intersection Observer to detect which heading is in view
                const observerOptions = {
                    rootMargin: '-20% 0px -70% 0px', // Trigger when heading is in top 30% of viewport
                    threshold: 0
                };
                
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        const id = entry.target.id;
                        const link = linkMap.get(id);
                        
                        if (entry.isIntersecting) {
                            // Remove active from all links
                            tocLinks.forEach(l => l.classList.remove('toc-link-active'));
                            // Add active to current link
                            if (link) {
                                link.classList.add('toc-link-active');
                            }
                        }
                    });
                }, observerOptions);
                
                // Observe all headings
                headings.forEach(heading => {
                    if (heading.id) {
                        observer.observe(heading);
                    }
                });
                
                // Set initial active state based on scroll position
                function setInitialActive() {
                    let activeHeading = null;
                    let maxTop = -Infinity;
                    
                    headings.forEach(heading => {
                        const rect = heading.getBoundingClientRect();
                        if (rect.top <= 100 && rect.top > maxTop) {
                            maxTop = rect.top;
                            activeHeading = heading;
                        }
                    });
                    
                    if (activeHeading && activeHeading.id) {
                        const link = linkMap.get(activeHeading.id);
                        if (link) {
                            tocLinks.forEach(l => l.classList.remove('toc-link-active'));
                            link.classList.add('toc-link-active');
                        }
                    }
                }
                
                // Set initial state
                setInitialActive();
                
                // Update on scroll (debounced)
                let scrollTimeout;
                window.addEventListener('scroll', () => {
                    clearTimeout(scrollTimeout);
                    scrollTimeout = setTimeout(setInitialActive, 100);
                });
            }
            
            function init() {
                initHighlight();
                initClipboard();
                initTOCActiveState();
            }
            
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', init);
            } else {
                init();
            }
        })();
    </script>
</body>
</html>

